## RFB ###################################################################
filter {
  if [event][dataset] == "rfb" {

      mutate {

          rename => {
            "[rfb][auth]" => "[rfb][authentication][successful]"
            "[rfb][authentication_method]" => "[rfb][authentication][method]"
            "[rfb][client_major_version]" => "[client][software][major]"
            "[rfb][client_minor_version]" => "[client][software][minor]"
            "[rfb][desktop_name]" => "[server][hostname]"
            "[rfb][height]" => "[rfb][desktop_height]"
            "[rfb][server_major_version]" => "[server][software][major]"
            "[rfb][server_minor_version]" => "[server][software][minor]"
            "[rfb][width]" => "[rfb][desktop_width]"
          }

          merge => { "[related][domain]" => "[server][hostname]" }

      }

      # Event outcome
      if [rfb][authentication][successful] {
        translate {
          field => "[rfb][authentication][successful]"
          exact => true
          dictionary => [
            "true", "success",
            "false", "failure"
          ]
          destination => "[event][outcome]"
        }
      }

  }
}