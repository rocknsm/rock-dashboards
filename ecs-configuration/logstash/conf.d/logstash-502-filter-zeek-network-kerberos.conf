## Kerberos ###################################################################
filter {
  if [event][dataset] == "kerberos" {
    if [kerberos] {

      mutate {
        rename => {
          "[kerberos][auth_ticket]" => "[kerberos][request][ticket][hash][md5]"
          "[kerberos][cipher]" => "[kerberos][request][ticket][cipher]"
          "[kerberos][client]" => "[kerberos][request][client]"
          "[kerberos][client_cert_subject]" => "[kerberos][request][certificate][subject]"
          "[kerberos][error_msg]" => "[kerberos][error_message]"
          "[kerberos][forwardable]" => "[kerberos][request][ticket][forwardable]"
          "[kerberos][from]" => "[kerberos][ticket][valid_from]"
          "[kerberos][new_ticket]" => "[kerberos][response][ticket][hash][md5]"
          "[kerberos][renewable]" => "[kerberos][request][ticket][renewable]"
          "[kerberos][request_type]" => "[kerberos][request][type]"
          "[kerberos][server_cert_subject]" => "[kerberos][response][certificate][subject]"
          "[kerberos][service]" => "[kerberos][ticket][service]"
          "[kerberos][success]" => "[kerberos][request][successul]"
          "[kerberos][till]" => "[kerberos][ticket][valid_till]"
        }
        copy => { "[kerberos][request][client]" => "[client][user][name]" }
        merge => { "[related][id]" => "[log][id][fuid]" }
      }
      mutate { merge => { "[related][id]" => "[log][id][client_cert_fuid]" } }
      mutate { merge => { "[related][id]" => "[log][id][server_cert_fuid]" } }

    }
  }
}
