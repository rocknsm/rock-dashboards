## Files ###################################################################
filter {
  if [event][dataset] == "files" {
    if [files] {

      mutate {
        rename => {
          "[files][rx_hosts]" => "[client][ip]"
          "[files][tx_hosts]" => "[server][ip]"
          "[files][filename]" => "[file][name]"
          "[files][is_orig]" => "[files][is_originating]"
          "[files][local_orig]" => "[files][local_origin]"
          "[files][md5]" => "[file][hash][md5]"
          "[files][mime_type]" => "[file][mime_type]"
          "[files][sha1]" => "[file][hash][sha1]"
          "[files][sha256]" => "[file][hash][sha256]"
          "[files][total_bytes]" => "[file][bytes]"
          "[files][source]" => "[network][protocol]"
        }
        copy => {
          "[log][id][fuid]" => "[event][id]"
          "[client][ip]" => "[client][address]"
          "[server][ip]" => "[server][address]"
        }
        merge => { "[related][id]" => "[log][id][conn_uids]" }
        merge => { "[related][id]" => "[log][id][fuid]" }
        merge => { "[related][ip]" => "[client][ip]" }
        merge => { "[related][ip]" => "[server][ip]" }
      }

    }
  }
}