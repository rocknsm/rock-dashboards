filter {
  if [@metadata][stage] == 'suricata_json' {
    ## HTTP ##################################################################
    if [http] {
      # Parse domain names & IPs from host header and also when crazy http headers like IbPK6g
      ruby {
        path => "/etc/logstash/ruby/logstash-ruby-filter-http-host-related.rb"
        script_params => {
          "source_field" => "[http][hostname]"
        }
      }

      mutate {
        rename => {
          "[http][http_content_type]" => "[http][response][mime_type]"
          "[http][length]" => "[http][response][body][bytes]"
          "[http][status]" => "[http][response][status_code]"
          "[http][http_user_agent]" => "[user_agent][original]"
        }
      }

    }
  }
}
