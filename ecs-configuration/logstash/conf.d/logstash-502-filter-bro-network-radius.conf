## Radius ###################################################################
filter {
  if [event][dataset] == "radius" {

      mutate {

          rename => {
            "[radius][framed_addr]" => "[radius][framed][ip]"
            "[radius][mac]" => "[radius][calling_station_id]"
            "[radius][remote_ip]" => "[radius][tunnel][client][endpoint]"
            "[radius][username]" => "[client][user][name]"
            "[radius][reply_msg]" => "[radius][reply_message]"
            "[radius][ttl]" => "[radius][time_to_live]"
          }

          copy => {
            "[radius][calling_station_id]" => "[radius][calling_station_id][mac]"
            "[radius][tunnel][client][endpoint]" => "[radius][tunnel][client][endpoint][ip]"
            "[radius][time_to_live]" => "[event][duration]"
          }

          merge => { "[related][ip]" => "[radius][tunnel][client][endpoint][ip]" }
          merge => { "[related][ip]" => "[radius][framed][ip]" }

      }
      #TODO:eventually parse [radius][tunnel][client][endpoint][ip] as ip or domain once the zeek/bro parser is fixed

      # Event outcome
      if [radius][result] {
        translate {
          field => "[radius][result]"
          exact => true
          dictionary => [
            "true", "success",
            "false", "failure"
          ]
          remove_field => "[radius][result]"
          destination => "[event][outcome]"
        }
      }

  }
}