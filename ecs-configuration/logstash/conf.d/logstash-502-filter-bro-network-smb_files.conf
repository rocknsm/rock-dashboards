## SMB_Files #############################################################
filter {
  if [event][dataset] == "smb_files" {
    if [smb_files] {

      mutate {

        rename => {
          "[smb_files][prev_name]" => "[smb][previous_name]"
          "[smb_files][size]" => "[file][size]"
          "[smb_files][times_accessed]" => "[smb][times][accessed]"
          "[smb_files][times_changed]" => "[smb][times][created]"
          "[smb_files][times_created]" => "[smb][times][changed]"
          "[smb_files][times_modified]" => "[smb][times][modified]"
        }

        copy => {
          "[smb_files][name]" => "[file][name]"
          "[smb_files][path]" => "[file][path]"
          "[smb_files][times][accessed]" => "[file][atime]"
          "[smb_files][times][created]" => "[file][crtime]"
          "[smb_files][times][changed]" => "[file][mtime]"
          "[smb_files][times][modified]" => "[file][ctime]"
        }

        merge => { "[related][id]" => "[log][id][fuid]" }

      }

    }
  }
}
