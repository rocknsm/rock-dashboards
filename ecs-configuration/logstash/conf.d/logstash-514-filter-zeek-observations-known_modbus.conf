## Known_Modbus ###################################################################
filter {
  if [event][dataset] == "known_modbus" {

      mutate {
        add_field => { "[network][transport]" => "tcp" }
        rename => {
          "[known_modbus][device_type]" => "[modbus][device_type]"
          "[known_modbus][host]" => "[host][ip]"
        }
        merge => { "[related][ip]" => "[host][ip]" }
      }

      if [modbus][device_type] == "Known::MODBUS_MASTER" {
        mutate {
          add_field => {
            "[client][ip]" => "%{[host][ip]}"
            "[client][address]" => "%{[host][ip]}"
          }
        }
      }

      else if [modbus][device_type] == "Known::MODBUS_SLAVE" {
        mutate {
          add_field => {
            "[server][ip]" => "%{[host][ip]}"
            "[server][address]" => "%{[host][ip]}"
          }
        }
      }

  }
}