filter {
  mutate {
    add_field => {
      "[@metadata][ENABLE_BRO_NETWORK]" => "${LS_ENABLE_BRO_NETWORK:true}"
      "[@metadata][ENABLE_BRO_FILES]" => "${LS_ENABLE_BRO_FILES:true}"
      "[@metadata][ENABLE_BRO_NETCONTROL]" => "${LS_ENABLE_BRO_NETCONTROL:true}"
      "[@metadata][ENABLE_BRO_DETECTION]" => "${LS_ENABLE_BRO_DETECTION:true}"
      "[@metadata][ENABLE_BRO_OBSERVATIONS]" => "${LS_ENABLE_BRO_OBSERVATIONS:true}"
      "[@metadata][ENABLE_BRO_MISC]" => "${LS_ENABLE_BRO_MISC:true}"
      "[@metadata][ENABLE_BRO_DIAG]" => "${LS_ENABLE_BRO_DIAG:true}"
    }

    convert => {
      "[@metadata][ENABLE_BRO_NETWORK]" => "boolean"
      "[@metadata][ENABLE_BRO_FILES]" => "boolean"
      "[@metadata][ENABLE_BRO_NETCONTROL]" => "boolean"
      "[@metadata][ENABLE_BRO_DETECTION]" => "boolean"
      "[@metadata][ENABLE_BRO_OBSERVATIONS]" => "boolean"
      "[@metadata][ENABLE_BRO_MISC]" => "boolean"
      "[@metadata][ENABLE_BRO_DIAG]" => "boolean"
    }

    add_field => {
      "[device][vendor]" => "RockNSM"
      "[device][version]" => "${LS_ROCKNSM_VERSION:}"
      "[device][type]" => "nsm sensor"
    }
  }
}
