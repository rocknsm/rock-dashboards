## SOCKS ###################################################################
filter {
  if [event][dataset] == "socks" {

    mutate {

      rename => {
        "[socks][bound_host]" => "[socks][bound][ip]"
        "[socks][bound_name]" => "[socks][bound][name]"
        "[socks][bound_p]" => "[socks][bound][port]"
        "[socks][password]" => "[client][user][password]"
        "[socks][request_host]" => "[socks][request][ip]"
        "[socks][request_name]" => "[socks][request][name]"
        "[socks][request_p]" => "[socks][request][port]"
        "[socks][user]" => "[client][user][name]"
      }

      merge => { "[related][ip]" => "[socks][bound][ip]" }
      merge => { "[related][ip]" => "[socks][request][ip]" }

    }

  }
}