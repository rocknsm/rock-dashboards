## DHCP ##################################################################
filter {
  if [event][dataset] == "dhcp" {

    if [dhcp] {
      mutate {
        # Assuming client port 67
        # Assuming clinet port 68
        add_field => {
          "[client][port]" => 68
          "[server][port]" => 67
        }
        rename => {
          "[dhcp][client_fqdn]" => "[client][fqdn]"
          "[dhcp][domain]" => "[client][domain]"
          "[dhcp][duration]" => "[event][duration]"
          "[dhcp][host_name]" => "[client][hostname]"
          "[dhcp][mac]" => "[client][mac]"

        }
        copy => {
          "[log][id][uids]" => "[event][id]"
          "[dhcp][client_software]" => "[client][software][original]"
          "[dhcp][server_software]" => "[server][software][original]"
          }
        merge => {
          "[related][id]" => "[log][id][uids]"
          "[related][ip]" => "[dhcp][assigned_addr]"
        }
      }
      mutate { merge => { "[related][ip]" => "[dhcp][msg_orig]" } }
      mutate { merge => { "[related][ip]" => "[dhcp][requested_addr]" } }
    }

  }
}